
==================================================
頁 1
==================================================
ORIGINALRESEARCH
published:16June2021
doi:10.3389/fams.2021.691582
Volumetric Lattice Boltzmann Models
in General Curvilinear Coordinates:
Theoretical Formulation
Hudong Chen*
DassaultSystemes,Waltham,MA,UnitedStates
A theoretical formulation of lattice Boltzmann models on a general curvilinear coordinate
system is presented. It is based on a volumetric representation so that mass and
momentum are exactly conserved as in the conventional lattice Boltzmann on a
Cartesian lattice. In contrast to some previously existing approaches for arbitrary
meshes involving interpolation approximations among multiple neighboring cells, the
current formulation preserves the fundamental one-to-one advection feature of a
standard lattice Boltzmann method on a uniform Cartesian lattice. The new approach
isbuiltontheconceptthataparticleismovingalongacurvedpath.Adiscretespace-time
inertial force is derived so that the momentum conservation is exactly ensured for the
underlying Euclidean space. We theoretically show that the new scheme recovers the
Editedby: Navier-Stokesequationingeneralcurvilinearcoordinatesinthehydrodynamiclimit,along
SnezhanaI.Abarzhi,
with the correct mass continuity equation.
UniversityofWesternAustralia,
Australia
Keywords: lattice Boltzmann methods, curvilinear coordinates, Riemann geometry, hydrodynamics, non-
Reviewedby: equilibriumphenomena
SemionSukoriansky,
Ben-GurionUniversityoftheNegev,
Israel
1 INTRODUCTION
XiaoboNie,
Halliburton,UnitedStates
Lattice Boltzmann Methods (LBM) have been developed as an advantageous method for
*Correspondence:
computational fluid dynamics during past few decades [1, 2]. The underlying dynamics of a
HudongChen
lattice Boltzmann system resides on the kinetic theory, in that it involves motion of many
hudong.chen@3ds.com
particles according to the Boltzmann equation [3, 4]. There are two fundamental dynamical
processes in a basic Boltzmann kinetic system, namely advection and collision. In the advection
Specialtysection:
process,aparticlemovesfromonelocationtoanotheraccordingtoitsmicroscopicvelocity,whilein
Thisarticlewassubmittedto
MathematicalandStatisticalPhysics, the collision process particles interact with each other obeying conservation laws and relax to
asectionofthejournal equilibrium.InastandardLBMmodel,particlevelocitytakesonadiscretesetofconstantvalues,and
FrontiersinAppliedMathematicsand the latter form exact links from one lattice site to its neighboring sites on a simple Bravais lattice
Statistics correspondingtoathreedimensional(3D)uniformcubicalCartesianmesh[5–7].Therefore,having
Received:06April2021 thesediscretevelocityvalues,aparticlemovesfromonelatticesitetoauniqueneighboringsiteper
Accepted:10May2021 constant time interval (say Δt (cid:1)1). This exact one-to-one advection of a particle on the lattice
Published:16June2021
effectively realizes a Lagrangian advection characteristics. That is, a particle location during the
Citation: advection process is exactly predicted at any later time from its location at a given time. Such a
ChenH(2021)VolumetricLattice LagrangianadvectioncharacteristicsisthereasonforoneofthekeyadvantagesofLBM,besidesits
BoltzmannModelsinGeneral
simplicity, the advection process produces an extremely low numerical dissipation (due to no
CurvilinearCoordinates:
smearing of locations of a single particle). Indeed, if such a one-to-one advection is relaxed,
TheoreticalFormulation.
numerical dissipation has been seen to significantly increase even with the usage of much higher
Front.Appl.Math.Stat.7:691582.
doi:10.3389/fams.2021.691582 orderinterpolationschemes.Inaddition,theLagrangianone-to-oneadvectionmayalsohavenon-
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 1 June2021|Volume7|Article691582

==================================================
頁 2
==================================================
Chen CurvilinearLBM
trivial implications in simulations of flows at finite Knudsen presented here and that of Mendosa et al. First of all, we
numbers [7–9]. In contrast, unlike particle velocity, a fluid adopt a volumetric formulation so that the mass and
velocity varies in both time and space, hence an one-to-one momentum conservations are exactly ensured. The resulting
advection process is impossible for a Navier-Stokes equation continuity equation of mass is automatically shown to have
based numerical scheme on a spatially fixed mesh. the correct form in curvilinear coordinates, and there is no
However, a uniform and cubical Cartesian mesh poses need to introduce any artificial mass source term to correct
fundamental limitations. First of all, often in realistic fluid for any artifacts in the resulting hydrodynamics. Secondly, as
study one deals with a solid geometry with curved surfaces, inthecontinuumkinetictheoryonamanifold,theonlyexternal
and obviously a Cartesian mesh does not smoothly conform sourcetermintheextendedLBMisassociatedwithaneffective
withsuchageometricshape.Secondly,aflowusuallyhassmall inertialforceduetocurvilinearity.Itcontributesnomasssource.
scale structures concentrated in certain spatial locations and Moreover,suchaforcetermisconstructedfullyself-consistently
directions. For instance, in the turbulent boundary layer, the withinthediscretelatticeformulation.Thisforceformindiscrete
flowscaleinthedirectionnormaltothewallismuchsmallerthan spaceandtimerecoversasymptoticallytheoneinthecontinuum
in the tangential direction or in the fluid region outside of the kinetictheoryinthehydrodynamiclimit.Itdoesnotrelyonany
boundary layer. Consequently, the requirement on spatial outside analytical forms borrowed from the continuum kinetic
resolution is significantly higher in the normal direction inside theory [14, 15]. Thirdly, the inertial force enforces the exact
a boundary layer. A cubic Cartesian mesh does not providethe momentum conservation for the underlying Euclidean space in
flexibilitywithdifferentspatialresolutionsindifferentdirections. thediscretespace-timeLBMmodel.Lastly,wedemonstratethat
Therefore,itisoffundamentalimportancetoextendthestandard the force term must be constructed properly so that it adds
LBM for a general non-cubic Cartesian mesh. momentum in the system at a proper discrete time moment in
There have been various attempts in the past to extend order to produce the correct resulting Navier-Stokes
LBM on arbitrary meshes, including curvilinear mesh (cf hydrodynamics to the viscous order. Indeed, the correct
[10–12]). The essential idea is to relax the aforementioned Navier-Stokes equation is fully recovered in the hydrodynamic
exactone-to-oneadvectionbetweenapairoflatticesiteswhile limit with the new formulation without introducing any extra
keeping the advection of particles according to the original correction terms.
constant discrete velocity values. As a consequence, on an Tosummarize,ourgoalistotheoreticallydemonstratehow
arbitrary mesh, a particle after advecting from its original discrete kinetic theories can be formulated in curvilinear
mesh site does not in general land on a single neighboring coordinates in a way that mass and momentum are exactly
meshsite.Thusitslocationneedstobedistributedontoaset conserved,andalsothecorrecthydrodynamicsisrecoveredin
of neighboring mesh sites via interpolation. As mentioned the microscopic limit. We hope the reader may find such
above, such an effective “one-to-many” advection process discrete non-equilibrium statistical systems interesting,
destroys the preciseness of a Lagrangian advection similar to discrete systems found in other branches of
characteristics thus resulting in a significantly increased physics, e.g., spin models on a lattice in the equilibrium
numerical dissipation. statistical theory, lattice field theories, etc. In addition to
ItisoffundamentalinteresttoformulateanLBMonageneral fundamental interest, non-equilibrium discrete systems like
mesh that preserves the exact one-to-one feature of the particle LBM may be useful for applications in numerical analysis
advection process. A possible way to accomplish this is to and for practical use. Computational aspects such as scheme
construct the micro-dynamic process on a non-Euclidean stability, numerical dissipation, performance, and boundary
space represented by a general curvilinear coordinate system conditions treatment, as well as numerical verification of
based on Riemann geometry [13]. In such a non-Euclidean theoretical results, are outside of the scope of this study. We
space, a constant particle velocity corresponds to a curved and alsorestrictourselvestooneofthesimplestsituations,namely
spatiallyvaryingpathintheunderlyingEuclideanspace.Indeed, the low speed isothermal flow, which admits a closed self-
the continuum Boltzmann kinetic theory on a Riemannian contained analytical treatment which explicates the main
manifold can be theoretically described [14, 15]. The key features of volumetric formulation in curvilinear coordinates.
difference between a constant particle velocity on a Euclidean Possible extensions and applications of this work are briefly
andanon-Euclideanspaceisthatthelatterisaccompaniedwith discussed in Section 4 below.
aninertialforce,duetothe1stlawofNewtoninEuclideanspace. Thedescriptionofnon-equilibriumdynamicsandtransportat
Accordingtothisconcept,itisentirelyconceivabletoformulate the spatio-temporal scales not treatable by hydrodynamics can
LBMmodelsonacubicCartesianlatticeinnon-Euclideanspace oftenbenefitfromusing kinetic theorymethods.Here weshow
thatcorresponds toageneralcurvilinearmeshintheEuclidean how to construct lattice kinetic theories in a general coordinate
space.ThefirstsuchattemptsweremadebyMendosaetal.ina system that possess exact conservation laws at both kinetic and
series of papers (see [16–18]). The significance of their work is continuumscales,aswellascorrectmacroscopiclimitbehavior.
that it established this fundamental approach to LBM on In addition to the fundamental interest, this can be useful for
curvilinear meshes via a Riemann geometric framework. describing interactions at interfaces between different fluids or
AsMendosaetal.,weformulateLBMonageneralcurvilinear materials with complex geometry.
coordinate system via the concept of Riemannian geometry. Thesubsequentsectionsareorganizedasfollows.Wedescribe
There are several critical differences between our approach in Section 2 the formulation of the new LBM on a general
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 2 June2021|Volume7|Article691582

==================================================
頁 3
==================================================
Chen CurvilinearLBM
curvilinearmesh.InSection3,weprovideadetailedtheoretical isonanon-Euclideanspaceasaresultofdistortionoftheoriginal
derivation and show that the new LBM indeed produces the Euclidean space.
correctNavier-Stokesequationingeneralcurvilinearcoordinates. When a curvilinear mesh is provided, spatial locations of all
Inorderforthepapertobemoreself-contained,weprovide,in thevertices{x}onthemesharespecified,andhencethedistance
Supplementary Appendices SA1–SA3 basic theoretical from any one vertex to another on a such mesh is also fully
description of the continuum Boltzmann kinetic theory in determined.Let’sdefinethedistancevectorfromx(q)tooneof
curvilinear coordinates as in the literature [15], some its neighbors x(q±i ) (i(cid:1)1,2,3) as
fundamental properties [13], as well as a derivation of the
Navier-Stokes hydrodynamic equation on a general curvilinear D±i (cid:1)q(cid:3)≡x(cid:1)q±i (cid:3)−x(cid:1)q(cid:3);i(cid:1)1,2,3 (1)
coordinate system.
For instance, D±1 (q)≡x(q1 ±1,q2,q3)−x(q1,q2,q3). Notice
that, due to spatial non-uniformity of a general curvilinear
mesh, the spatial distance from one mesh site to its nearest
2 FORMULATION OF LATTICE
neighbor site is in general changing from location to location.
BOLTZMANN IN CURVILINEAR Inotherwords,D±i (q)isafunctionofq.Furthermore,onecan
COORDINATES realizethatthedistancevalueinthepositivedirectionalongthe
ithcoordinatecurveisingeneralnotequaltothatinthenegative
This section is divided into two subsections. First, we construct
direction. Explicitly, in terms of the distance vectors,
thegeometricquantitiesthatarenecessaryfordefiningageneral
curvilinear coordinate system. Then we present the volumetric
D
i
(q)≠ −D−i (q). For example, according to the definition of
Eq. 1,
lattice Boltzmann formulation on a general curvilinear mesh.
D−1 (cid:1)q(cid:3)(cid:1)x(cid:1)q1−1,q2,q3(cid:3)−x(cid:1)q1,q2,q3(cid:3)(cid:1)−D
1
(cid:1)q1−1,q2,q3(cid:3)
2.1ConstructionofGeometricQuantitieson ≠ −D (cid:1)q(cid:3)(cid:1)−(cid:1)x(cid:1)q1+1,q2,q3(cid:3)−x(cid:1)q1,q2,q3(cid:3)(cid:3)
1
a Curvilinear Mesh (2)
We describe how to construct a coordinate system for
and the inequality only becomes an equality everywhere if the
formulating kinetic theory on a curvilinear mesh. Let x be
curvilinear mesh is a uniform lattice (so that |D|(cid:1)const,
any spatial point in 3D Euclidean space. We choose a i
independent of spatial coordinate value q).
curvilinear coordinate system, so that x(cid:1)x(q) is uniquely
Following the basic differential geometry concept, we now
defined by q. Here q≡(q1,q2,q3) are the coordinate values
constructthebasistangentvectorsatx(q)alongeachofthethree
along three non-collinear congruences of parameterized basis
coordinate directions,
curves. The above forms the basic starting point for a general
c
sp
u
a
rv
ti
i
a
li
l
n
l
e
a
a
y
r
o
m
ut
e
i
s
s
h
g
.F
iv
o
e
r
n
w
,t
h
h
e
e
n
n
a
a
3
ll
D
it
c
s
u
v
r
e
v
r
il
t
i
e
n
x
ea
lo
r
c
m
at
e
i
s
o
h
ns
w
i
i
n
th
s
i
p
ts
ac
e
e
nt
a
i
r
r
e
e g
i
(cid:1)q(cid:3)≡β
i
(cid:1)q(cid:3)(cid:4)D
i
(cid:1)q(cid:3)−D−i (cid:1)q(cid:3)(cid:5)(cid:6)2Δx;i(cid:1)1,2,3 (3)
known and specified. Let x now be only defined on sites where the scalar factor β(q) is
i
x
(
c
i
o
.
a
e
o
n
.
r
,
d
di
v
q
n
e
.
a
r
I
t
t
n
e
ic
o
s
e
y
s
th
)
st
e
e
r
m
o
w
f
o
{q
t
r
h
d
}
e
s
t
,
h
f
c
a
o
u
t
r
r
i
a
v
s
n
il
a
y
in
s
o
e
i
n
a
te
r
e-
x
t
m
o
o
-
n
e
o
s
n
t
h
h
e
.
e
m
c
W
u
a
r
p
e
v
p
i
i
l
c
n
in
h
g
e
o
a
o
b
r
s
e
e
t
m
w
e
e
t
s
e
h
h
n
e
,
β
i
(cid:1)q(cid:3)≡ (cid:4)
(cid:7)(cid:7)(cid:7)(cid:7)
(cid:7)(cid:7)(cid:7)(cid:7) D
D
i
i
(cid:1)
(cid:1)
q
q
(cid:3)
(cid:3)
(cid:7)(cid:7)(cid:7)(cid:7)
−
+
D
(cid:7)(cid:7)(cid:7)(cid:7)D
−
−
i (cid:1)
i (cid:1)
q
q
(cid:3)
(cid:3) (cid:7)(cid:7)(cid:7)(cid:7)
(cid:7)(cid:7)(cid:7)(cid:7)(cid:5)
there is a unique value q associated with it, that is x(cid:1)x(q) is
uniquely defined. In addition, we construct the coordinate andβ i (q)(cid:1)1whenthetwodistancevectorsD i (q)and−D−i (q)
values of q on the mesh as follows: For any site x(q), its are parallel. With such a construction, the parity symmetry is
nearest neighbor site along the ith (i(cid:1)1,2,3) coordinate achieved, so that
curve in the positive or negative direction is a spatial point g(cid:1)q(cid:3)(cid:1)−g (cid:1)q(cid:3)
x±i .Due totheuniquemapping, we have x±i (cid:1)x(q±i ), where i −i
q±i is a unique coordinate value for the neighboring site. It is Notice, in Eq. 3 Δx is a length scale corresponding to a
entirely possible to choose the spatial variation of q in such a representative vertex spacing of the mesh. It is well known
waythatq±i andqonlydifferintheirithcoordinatecomponent that, unlike a Cartesian coordinate system in Euclidean space,
valuesbyaconstantd 0 .Thatis,q±i (cid:1)(q1 ±i ,q2 ±i ,q3 ±i ),andqj ±i − the basis tangent vectors g i (q) (i(cid:1)1,2,3) of a curvilinear
qj (cid:1) ±d δj (i,j(cid:1)1,2,3). Here wechoose the constant d tobe coordinate system are not orthonormal in general. That is,
0 i 0
unity without loss of generality. g(q)·g(q)≠δ . Hence, we should further define the
i j ij
Itiseasytoseethat,undersuchaconstruction,thecoordinate corresponding metric tensor based on these basis tangent
values {q} actually form a simple uniform 3D cubic Cartesian vectors,
lattice with the lattice spacing unity. One may interpret this
“Cartesian” lattice {q} as a result of deformation (bending, g ij (cid:1)q(cid:3)≡g i (cid:1)q(cid:3)·g j (cid:1)q(cid:3), i,j(cid:1)1,2,3 (4)
twisting and stretching/compressing) of the original curvilinear as well as the volume J of the cell centered at x(q),
mesh{x}intheEuclideanspace.Thus,itstopologicalstructureis
thesameastheoriginalcurvilinearmesh,buttheCartesianlattice J(cid:1)q(cid:3)≡(cid:1)g (cid:1)q(cid:3)×g (cid:1)q(cid:3)(cid:3)·g (cid:1)q(cid:3) (5)
1 2 3
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 3 June2021|Volume7|Article691582

==================================================
頁 4
==================================================
Chen CurvilinearLBM
andwecanalwayschooseaproperhandednesssothatJ(q)>0. {wα ;α(cid:1)1,...,b}, the set of lattice component vectors admit
ClearlyJ(q)isaconstantinspaceforauniformBravaislattice. moment isotropy up to the 6th order, namely
One can easily verify that
(cid:10)wα (cid:1)1
g(cid:1)q(cid:3)≡det(cid:8)g (cid:1)q(cid:3)(cid:9)(cid:1)J2(cid:1)q(cid:3) (6) α
ij
with det[g (q)] being the determinant of the metric tensor
(cid:10)wαci
α
cj
α
(cid:1)T
0
δij ≡T
0
Δ(2),ij
ij α
[
v
g
e
i
c
j (
to
q
r
)
s
].
gi
F
(
u
q)
rt
(
h
i
e
(cid:1)
rm
1
o
,2
re
,
,
3)
w
a
e
cco
c
r
a
d
n
ing
d
l
e
y
fi
,
ne the co-tangent basis (cid:10)wαci
α
cj
α
ck
α
cl
α
(cid:1)T
0
2(cid:8)δijδkl+δikδjl+δilδjk(cid:9)≡T
0
2Δ(4),ijkl
α
g1(cid:1)q(cid:3)≡g (cid:1)q(cid:3)×g (cid:1)q(cid:3)(cid:6)J(cid:1)q(cid:3)
(cid:10)wαci
α
cj
α
ck
α
cl
α
cm
α
cn
α
2 3 α
g2(cid:1)q(cid:3)≡g (cid:1)q(cid:3)×g (cid:1)q(cid:3)(cid:6)J(cid:1)q(cid:3) δijΔ(4),klmn+δikΔ(4),jlmn+δilΔ(4),jkmn
g3(cid:1)q(cid:3)≡g
3
(cid:1)q(cid:3)×g
1
(cid:1)q(cid:3)(cid:6)J(cid:1)q(cid:3) (7)
(cid:1)T
0
3(cid:12)
+δimΔ(4),jkln+δinΔ(4),jklm
(cid:13)≡T
0
3Δ(6),ijklmn
1 2
(10)
Indeed,thebasistangentvectorsandtheco-tangentvectorsare
orthonormal to each other,
where the constant T depends on the choice of a set of lattice
0
g(cid:1)q(cid:3)·gj(cid:1)q(cid:3)(cid:1)δj, i,j(cid:1)1,2,3
vectorsandδijistheKroneckerdeltafunction.Forexample,T
0
(cid:1)
i i 1/3forthesocalledD3Q19lattice(albeititonlysatisfiesEq.10
whereδjistheKroneckerdeltafunction.Similarly,wecandefine up to the 4th order). Notice, one should not confuse the three
i
the inverse metric tensor, dimensional array cα with the lattice vector eα (q) in Eq. 9. The
former is simply an array of three constant (integer) numbers,
gij(cid:1)q(cid:3)≡gi(cid:1)q(cid:3)·gj(cid:1)q(cid:3), i,j(cid:1)1,2,3 (8) while the latter is a vector (with a well defined direction and
magnitude) at q on the curvilinear mesh.
Clearly the inverse metric tensor is the inverse of the metric
tensor, [gij(q)](cid:1)[g (q)]−1, or Lastly, we define a set of specific geometric quantities below
ij
that are essential for the extended LBM model,
3
(cid:10)
k(cid:1)1
g ik (cid:1)q(cid:3)gkj(cid:1)q(cid:3)(cid:1)δj i Θi
j
(cid:1)q+cα ,q(cid:3)≡(cid:8)g
j
(cid:1)q+cα (cid:3)−g
j
(cid:1)q(cid:3)(cid:9)·gi(cid:1)q(cid:3)
i,j(cid:1)1,2,3;α(cid:1)0,1,...,b (11)
and
det(cid:4)gij(cid:1)q(cid:3)(cid:5)(cid:1)1(cid:11)det(cid:8)g
ij
(cid:1)q(cid:3)(cid:9) ItiseasilyseenthatΘi
j
(q+cα ,q)vanishifthemeshisauniform
Cartesian lattice.
Havingthesebasicgeometricquantitiesdefinedabove,wecan Once a curvilinear mesh is specified, all the geometric
nowintroducethelatticeBoltzmannvelocityvectorsonageneral quantities above are fully determined and can thus be pre-
curvilinear mesh, similar to the ones on a standard Cartesian computed before starting a dynamic LBM simulation.
lattice,
Δx 2.2 Volumetric Lattice Boltzmann Model on
eα (cid:1)q(cid:3)≡ci
α
g
i
(cid:1)q(cid:3)
Δt
(9)
a Curvilinear Mesh
Here and thereafter, the summation convention is used for Although the basic theoretical framework of the work is more
repeated Roman indices. For convenience, in subsequent general,forsimplicityofdescribingthebasicconcept,wepresent
derivations we adopt the ‘lattice units’ convention so that Δx theformulationforthesocalledisothermalLBMinthissection.
(cid:1) 1 and Δt (cid:1)1. The constant number ci is either a positive or Similar to the standard lattice Boltzmann equation (LBE), we
α
negativeintegerorzero,anditistheithcomponentvalueofthe write the evolution of particle distribution below [1, 5, 21–23]
t in hr t e h e e d s im o e c n al s l i e o d na D l 3 c Q oo 1 r 9 di w n i a t t h e t a h r e ra G y r c e α e ≡ k i ( n c d 1 α e , x c2 α α ,c3 α ru ). n F n o i r ng ex f a r m om ple 0 , Nα (cid:1)q+cα ,t+1(cid:3)(cid:1)Nα (cid:1)q,t(cid:3)+Ω α (cid:1)q,t(cid:3)+δNα (cid:1)q,t(cid:3) (12)
to 19,5 whereNα (q,t)isthenumberofparticlesbelongingtothediscrete
directioncα inthecellqattimet.WehaveassumedinEq.12a
cα ∈{(0,0,0),(±1,0,0),(0, ±1,0),(0,0, ±1),(±1, ±1,0), unity time increment (i.e., Δt (cid:1)1) without loss of generality.
(±1,0, ±1),(0, ±1, ±1)} Ω
α
(q,t)inEq.12isthecollisiontermthatsatisfieslocalmassand
momentum conservations,
Asshowninthesubsequentsections,asetofnecessarymoment
isotropyandnormalizationconditionsmustbesatisfiedinorder (cid:10)Ω α (cid:1)q,t(cid:3)(cid:1)0
α
torecoverthecorrectfullNavier-Stokeshydrodynamics[6,7,19,
20].Theseare,whenthereexistsapropersetofconstantweights (cid:10)eα (cid:1)q(cid:3)Ω α (cid:1)q,t(cid:3)(cid:1)0 (13)
α
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 4 June2021|Volume7|Article691582

==================================================
頁 5
==================================================
Chen CurvilinearLBM
The particle density distribution function fα (q,t) is related to The extra term δNα (q,t) in Eq. 12 represents the change of
Nα (q,t), via particle distribution due to an effective inertial force associated
with the curvature and non-uniformity of a general curvilinear
J(cid:1)q(cid:3)fα (cid:1)q,t(cid:3)(cid:1)Nα (cid:1)q,t(cid:3) (14) mesh. Obviously δNα (q,t) vanishes in the standard LBM on a
where J(q) is the volume of cell centered at q, as defined Cartesian lattice. We explain and construct its explicit
previously. The fundamental fluid quantities are given by the form below.
standard hydrodynamic moments, We define the advection process as an exact one-to-one hop
from one site to another as in the standard LBM, namely
ρ(cid:1)q,t(cid:3)(cid:1)(cid:10)fα (cid:1)q,t(cid:3)
α Nα (cid:1)q+cα ,t+1(cid:3)(cid:1)Nα ′(cid:1)q,t(cid:3) (22)
ρ(cid:1)q,t(cid:3)u(cid:1)q,t(cid:3)(cid:1)(cid:10)eα (cid:1)q(cid:3)fα (cid:1)q,t(cid:3) (15) where Nα ′(q,t) is the post-collide distribution at (q,t) that is
α
equaltotherightsideofEq.12.Duetocurvilinearity,thoughthe
where ρ(q,t) and u(q,t) are fluid density and velocity at the amountofparticlesadvectedfromcellqisexactlyequaltowhatis
location x(q) and time t. Using the relationship in Eq. 9, the arrivedatcellq+cα (asdefinedinEq.22),themomentumisin
velocity moment above can also be rewritten as fact changed along the way. Indeed, in general
ρ(cid:1)q,t(cid:3)u(cid:1)q,t(cid:3)(cid:1)(cid:10)ci
α
g
i
(cid:1)q(cid:3)fα (cid:1)q,t(cid:3) eα (cid:1)q+cα (cid:3)Nα (cid:1)q+cα ,t+1(cid:3)≠eα (cid:1)q(cid:3)Nα ′(cid:1)q,t(cid:3)
α
Intheabove,theleftsideoftheinequalitysignisthemomentum
(cid:1)ρ(cid:1)q,t(cid:3)Ui(cid:1)q,t(cid:3)g(cid:1)q(cid:3) (16)
i valueattheendofadvectionprocesswhiletherightsideisthevalue
and the velocity component value in the curvilinear coordinate atthebeginningoftheprocess.Theinequalityistherebecausethe
system is given by, pathofparticlesiscurved(aswellasstretchedorcompressed),so
that its velocity at the end of the advection is changed from its
ρ(cid:1)q,t(cid:3)Ui(cid:1)q,t(cid:3)(cid:1)(cid:10)ci α fα (cid:1)q,t(cid:3) (17) original value. This is fundamentally different from that on a
α
uniform Cartesian lattice, in that the particles have a constant
Orforsimplicityofnotation,wedefineathree-dimensionalfluid velocitythroughouttheadvectionprocess.Consequently,wehave
velocity array U(q,t)≡(U1(q,t),U2(q,t),U3(q,t)). Therefore, the following inequalities inthe overallmomentumvalues,
Eq. 17 can be equivalently expressed as
(cid:10)eα (cid:1)q(cid:3)Nα (cid:1)q,t(cid:3)≠(cid:10)eα (cid:1)q−eα (cid:3)Nα ′(cid:1)q−cα ,t−1(cid:3) (23)
ρ(cid:1)q,t(cid:3)U(cid:1)q,t(cid:3)(cid:1)(cid:10)cαfα (cid:1)q,t(cid:3) (18) α α
α
wheretherightsideoftheunequalsigninEq.23representsthe
ItisimmediatelyseenthatEq.18hasthesameformforthefluid totalamountofmomentumadvectedoutofalltheneighboring
velocity as that in the standard Cartesian lattice based LBM. cells, while the left side is the total momentum arrived at cell q
Similarly, the momentum conservation of the collision term in aftertheadvectionalongthecurvedpaths.ThusfromEqs22,23,
Eq. 13 can also be written as, weseethatthenetmomentumchangeviaadvectionfromallthe
neighboring cells into cell q is given by,
(cid:10)cα Ω α (cid:1)q,t(cid:3)(cid:1)0 (19)
α J(cid:1)q(cid:3)χI(cid:1)q,t(cid:3)(cid:1)−(cid:10)(cid:4)eα (cid:1)q(cid:3)−eα (cid:1)q−cα (cid:3)(cid:5)Nα (cid:1)q,t(cid:3) (24)
α
OfteninLBMthecollisiontermtakesonalinearizedform[1,
Similarly, we can realize that the net momentum change via
20], namely
advection out of cell q to all its neighboring cells is given by
Ω α (cid:1)q,t(cid:3)(cid:1)(cid:10)
β
J(cid:1)q(cid:3)Mαβ (cid:8)fβ (cid:1)q,t(cid:3)−f β eq(cid:1)q,t(cid:3)(cid:9) (20) J(cid:1)q(cid:3)χo(cid:1)q,t(cid:3)(cid:1)−(cid:10)(cid:8)eα (cid:1)q+cα (cid:3)−eα (cid:1)q(cid:3)(cid:9)Nα ′(cid:1)q,t(cid:3) (25)
α
where Mαβ and f β eq(q,t) represent a collision matrix and the Subsequently, if we impose the constraints on δNα (q,t) below,
equilibriumdistributionfunction,respectively.Inparticular,the
so called Bhatnagar-Gross-Krook (BGK) form corresponds to
(cid:10)δNα (cid:1)q,t(cid:3)(cid:1)0
α
Mαβ (cid:1)− 1 τ δ αβ (cid:10)eα (cid:1)q(cid:3)δNα (cid:1)q,t(cid:3)(cid:1)J(cid:1)q(cid:3)χ(cid:1)q,t(cid:3) (26)
α
withτbeingthecollisionrelaxationtime[5,22–24].Inorderto
thenwepreserveanexactmassconservationaswellasrecoverthe
recover the correct Navier-Stokes hydrodynamics, besides Eqs exact momentum conservation in discrete space-time for the
13,19thecollisionmatrixneedstosatisfyanadditionalcondition underlyingEuclideanspace.Hereχ(q,t)(cid:1)[χI(q,t)+χo(q,t)]/2.
[8, 9, 20, 25–27], More specifically, the first constraint in Eq. 26 means that no
(cid:10)cαcαMαβ (cid:1)− 1 τ cβcβ (21) m sec a o ss nd so c u o rc n e st i r s ai i n n t tr i o n du E c q e . d 2 b 6 y in δN tr α o ( d q u , c t e ) s . O an n “ t i h n e er o t t i h al er fo h r a c n e” d, th th a e t
α
equals exactly to the amount needed for achieving the
ObviouslytheBGKformtriviallysatisfiessuchanadditionalproperty. momentum conservation in the underlying Euclidean space at
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 5 June2021|Volume7|Article691582

==================================================
頁 6
==================================================
Chen CurvilinearLBM
anylatticesiteqandtimet.Themechanismisinanalogywiththe In the above,
continuum kinetic theoretic description in a curved space.
Writing in the coordinate component form, we have U ~i(cid:1)q,t(cid:3)(cid:1)Ui(cid:1)q,t(cid:3)+ 1 ai(cid:1)q,t(cid:3)
2
Fi(cid:1)q,t(cid:3)(cid:1)χ(cid:1)q,t(cid:3)·gi(cid:1)q(cid:3)
with ρ(q,t)ai(q,t)≡Fi(q,t). It is straightforward to show that
Usingthegeometricquantitiesdefinedintheprevioussubsection,
these fundamental conditions are met by the following
it can be immediately shown that equilibrium distribution form,
J(cid:1)q(cid:3)Fi(cid:1)q,t(cid:3)(cid:1)− 1 2 (cid:10) α cj α (cid:14)Θi j (cid:1)q+cα ,q(cid:3)Nα ′(cid:1)q,t(cid:3) f α eq (cid:1)ρwα (cid:20)1+ ci α T U 0 i + 2 1 T 0 (cid:18) c T i α c 0 j α−δij(cid:19)(cid:8)(cid:21)gij−δij(cid:22)T 0 +U ~i U ~j(cid:9)
−Θi j (cid:1)q−cα ,q(cid:3)Nα (cid:1)q,t(cid:3)(cid:15) (27) + 1 (cid:21)cicjck−T (cid:21)ciδjk+cjδki+ckδij(cid:22)(cid:22)(cid:8)T (cid:8)(cid:21)gijU ~k
6T3 α α α 0 α α α 0
wherethe geometricfunction Θi
j
(q+cα ,q) isdefinedin Eq. 11. 0
FromEqs11,27,onecanimmediatelyseethatFi(q,t)vanishesif −δijUk(cid:22)+(cid:21)gjkU ~i−δjkUi(cid:22)+(cid:21)gkiU ~j−δkiUj(cid:22)(cid:9)+U ~i U ~j U ~k(cid:9)(cid:23)
thecurvilinearmeshisaregular uniformCartesianlattice,asis
obviouslythecaseforabasicLBM.ThesecondconstraintinEq. (33)
26 can also be expressed in coordinate component form as
Theequilibriumdistributionformaboveisanalogoustothatofa
(cid:10)ci
α
δNα (cid:1)q,t(cid:3)(cid:1)J(cid:1)q(cid:3)Fi(cid:1)q,t(cid:3) (28) low Mach number expansion of the Maxwell-Boltzmann
α distribution expressed in curvilinear coordinates [14]. It
Astobedemonstratedinthenextsection,inordertorecoverthe reduces to the standard LBM equilibrium distribution if the
full viscousNavier-Stokesequation, anadditionalconstrainton curvilinear mesh is a uniform Cartesian lattice so that gij (cid:1)δij
the momentum flux also needs to be imposed below, [7, 19, 20].
With all the quantities and dynamic properties defined
(cid:10)ci α cj α δNα (cid:1)q,t(cid:3)(cid:1)J(cid:1)q(cid:3)(cid:4)δΠij(cid:1)q,t(cid:3)+δΠji(cid:1)q,t(cid:3)(cid:5) (29) above, we can show that the lattice Boltzmann Eq. 12
α computed on the (non-Euclidean) uniform Cartesian lattice
with {q} obeys the Navier-Stokes hydrodynamics in curvilinear
coordinates. Consequently, mapping of the resulting fluid
1 1
δΠij(cid:1)q,t(cid:3)≡ − 2 (cid:16)1− 2τ (cid:17)(cid:10)ci α ck α (cid:8)Θj k (cid:1)q+cα ,q(cid:3)−Θj k (cid:1)q−cα ,q(cid:3)(cid:9)f α eq(cid:1)q,t(cid:3) values, ρ(q,t) and Ui(q,t), onto the curvilinear mesh is given
α
by a simple transformation below,
(30)
A specific form of δNα (q,t) can be chosen below
ρ(cid:1)x(cid:1)q(cid:3),t(cid:3)(cid:1)ρ(cid:1)q,t(cid:3),
u(cid:1)x(cid:1)q(cid:3),t(cid:3)(cid:1)Ui(cid:1)q,t(cid:3)g(cid:1)q(cid:3) (34)
cjFj(cid:1)q,t(cid:3) cjck δΠjk(cid:1)q,t(cid:3) i
δNα (cid:1)q,t(cid:3)(cid:1)wαJ(cid:1)q(cid:3)(cid:12) α +(cid:18) α α−δjk(cid:19) (cid:13) (31)
T T T
0 0 0
Withasimplealgebra,onecanverifythatitsatisfiesthemoment 3 DERIVATION OF THE NAVIER-STOKES
constraints of Eqs 26, 28, 29. Notice, due to the appearance of HYDRODYNAMICS IN CURVILINEAR
Nα ′(q,t) in Eq. 27, the overall collision process for determining
COORDINATES
Nα ′(q,t)definesanimplicitrelationship,sothatvariouswaysto
handleitneedtobeexploreddependingontypesflowsofinterest.
Inthissection,weprovideadetailedderivationandshowthatthe
ThefinalpartforcompletespecifyingtheextendedLBMona
extended LBM presented above indeed produces the correct
curvilinear mesh is the form of the equilibrium distribution Navier-Stokes equations in general curvilinear coordinates. We
function, which needs to be defined appropriately in order to rewrite the lattice Boltzmann Eq. 12) below,
recover the correct Euler equation as well as the Navier-Stokes
equationincurvilinearcoordinatesinthehydrodynamiclimit.In Nα (cid:1)q+cα ,t+1(cid:3)(cid:1)Nα (cid:1)q,t(cid:3)+Ω α (cid:1)q,t(cid:3)+δNα (cid:1)q,t(cid:3) (35)
particular, the following fundamental conditions on Expanding it in both time and space up to the second order
hydrodynamic moments must be realized, leads to
(cid:10)feq (cid:1)ρ, z 1 z 2
α α (cid:12)z t +ci αzqi + 2 (cid:18)z t +ci αzqi (cid:19) (cid:13)Nα (cid:1)Ω α +δNα (36)
(cid:10)ci feq (cid:1)ρUi,
α α
α Now we introduce multiple scales in time and space based on
(cid:10)ci α cj α f α eq ≡Πij,eq (cid:1)gijρT 0 +ρU ~i U ~j, the conventional Chapman-Enskog expansion procedure,
α
[21, 28]
(cid:10)cicjckfeq ≡Qijk,eq (cid:1)(cid:8)gijU ~k+gjkU ~i+gkiU ~j(cid:9)ρT +ρU ~i U ~j U ~k
α α α α 0 z z
α z (cid:1)ϵz +ϵ2z ; (cid:1)ϵ
(32) t t0 t1 zqi zqi
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 6 June2021|Volume7|Article691582

==================================================
頁 7
==================================================
Chen CurvilinearLBM
and Combining Eq. 43 and Eq. 44, we get
Nα (cid:1)N α eq+ϵN α (1)+ϵ2N α (2)+/ z(cid:10)Neq+ z (cid:10)ciNeq+ 1 z (cid:10)ciδN(0) (cid:1)0 (45)
t α zqi α α 2 zqi α α
Hereϵ(≪1)denotesasmallnumber.Conservationlawsrequire, α α α
Substitute the definitions in Eqs 37, 45 becomes
(cid:10)N
α
eq (cid:1)(cid:10)Nα (cid:1)Jρ,(cid:10)ci
α
N
α
eq (cid:1)(cid:10)ci
α
Nα (cid:1)JρUi
α α α α z a(0),i
(cid:10)N α (n) (cid:1)(cid:10)ci α N α (n) (cid:1)0;n>0 (37) z t (cid:1)Jρ(cid:3)+ zqi (cid:12)Jρ(cid:18)Ui+ 2 (cid:19)(cid:13)(cid:1)0 (46)
α α
where
Likewise, δNα (cid:1)ϵδN
α
(0)+ϵ2δN
α
(1)+/, and
(cid:10)ciδN(0) ≡Jρa(0),i (47)
α α
(cid:10)δN
α
(n) (cid:1)0; n(cid:1)0,1,...
α
α is to be further discussed later in this section. Define the fluid
fortheyintroducenosourceofmass.Equatingthesamepowers velocity as
of ϵ, Eq. 36 leads to the following two equations U ~i ≡Ui+ 1 a(0),i (48)
z 2
(cid:18)z
t0
+ci
αzqi
(cid:19)N
α
eq (cid:1)(cid:10)MαβN
β
(1)+δN
α
(0) (38)
andsinceJ (cid:1)J(q)isnotafunctionoftime,Eq.46isinfactthe
β
standard mass continuity equation expressed in general
and
curvilinear coordinates,
1 z 2 z
z t1 N α eq+ 2 (cid:18)z t0 +ci αzqi (cid:19) N α eq+(cid:18)z t0 +ci αzqi (cid:19)N α (1) z t ρ+ 1 J z z qi (cid:21)JρU ~i(cid:22)(cid:1)0 (49)
(cid:1)(cid:10)
β
MαβN
β
(2)+δN
α
(1) (39)
Recognizingthat1
J z
z
qi
(JAi)(cid:1)∇·AisthedivergenceofavectorA
in a general curvilinear coordinate system, Eq. 49 is simply the
wherethecollisiontermhastakenthelinearizedforminEq.20.
familiar mass continuity equation in the coordinate free
Eq. 38 can be directly inverted, representation,
z
N α (1) (cid:1)(cid:10)M α − β 1(cid:12)(cid:18)z t0 +ci βzqi (cid:19)N β eq−δN β (0)(cid:13) (40) z t ρ+∇·(cid:1)ρu~(cid:3)(cid:1)0 (50)
β
Taking the momentum moment of Eq. 38, we get,
Therefore, Eq. 39 can also be written as,
z
(cid:10)ci(cid:18)z +cj (cid:19)Neq (cid:1)(cid:10)ciδN(0) (51)
z
t1
N
α
eq+ 1
2
(cid:18)z
t0
+ci
αz
z
qi
(cid:19) ⎡⎢⎢⎣(cid:10)MαβN
β
(1)+δN
α
(0)⎤⎥⎥⎦ α α t0 αzqj α α α α
β Define (see also in Eq. 32)
z
+ (cid:18)z t0 +ci αzqi (cid:19)N α (1) JΠij,eq ≡(cid:10)ci
α
cj
α
N
α
eq (52)
α
(cid:1)(cid:10)MαβN
β
(2)+δN
α
(1) (41)
β together with Eq. 47, Eq. 51 becomes
z
Taking the mass moment of Eqs 38, 41, and using mass z (cid:1)JρUi(cid:3)+ (cid:1)JΠij,eq(cid:3)(cid:1)Jρa(0),i (53)
conservation properties of Mαβ and δN (n) above, we obtain for t0 zqj
the leading order
Similarly, taking the momentum moment of Eq. 41,
z
(cid:10) α (cid:18)z t0 +ci αzqi (cid:19)N α eq (cid:1)0 (42) z t1 (cid:10)ci α N α eq+(cid:10)ci α cj αz z qj (cid:10)(cid:30)δ αβ + 1 2 Mαβ (cid:31)N β (1)
α α α
Based on the equilibrium moment definitions Eqs 37, 42 is 1 z
equivalent to
+
2
(cid:10)ci
α
(cid:18)z
t0
+cj
αzqj
(cid:19)δN
α
(0)
α
z
z (cid:1)Jρ(cid:3)+ (cid:1)JρUi(cid:3)(cid:1)0 (43) (cid:1)(cid:10)ci α δN α (1) (54)
t0 zqi
α
For the next order, we have Let
z t1 (cid:10)N α eq+ 1 2 z z qi (cid:10)ci α δN α (0) (cid:1)0 (44) JΠij,(1) ≡(cid:10)ci α cj α (cid:10)(cid:16)δ αβ + 1 2 Mαβ (cid:17)N β (1) (55)
α α α α
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 7 June2021|Volume7|Article691582

==================================================
頁 8
==================================================
Chen CurvilinearLBM
and use relation Eq. 40, we can derive with JFi given by Eq. 27,
JΠij,(1) (cid:1)(cid:10) α ci α cj α (cid:10) β (cid:16)δ αβ + 1 2 Mαβ (cid:17)(cid:10) c M β − c 1(cid:12)(cid:18)z t0 +ck cz z qk (cid:19)N c eq−δN c (0)(cid:13) J(cid:1)q(cid:3)Fi(cid:1)q,t(cid:3)(cid:1)− 1 2 (cid:10) α cj α (cid:14)Θi j (cid:1)q+cα ,q(cid:3)Nα ′(cid:1)q,t(cid:3)
(cid:1)(cid:10)ci
α
cj
α
(cid:10)(cid:16)M
α
−
β
1+ 1
2
δ
αβ
(cid:17)(cid:12)(cid:18)z
t0
+ck
βz
z
qk
(cid:19)N
β
eq−δN
β
(0)(cid:13) −Θi j (cid:1)q−cα ,q(cid:3)Nα (cid:1)q,t(cid:3)(cid:15) (62)
α β where Θi
j
(q+cα ,q) is defined in Eq. 11. Taking the continuum
(56) limit, we have for the leading order of Θi
j
(q+cα ,q)
Using the collision matrix property Eq. 21 and its inverse,
namely
Θi
j
(cid:1)q+cα ,q(cid:3)≡(cid:8)g
j
(cid:1)q+cα (cid:3)−g
j
(cid:1)q(cid:3)(cid:9)·gi(cid:1)q(cid:3)
zg(cid:1)q(cid:3)
(cid:10)cαcαMαβ (cid:1)− 1 τ cβcβ ;(cid:10)cαcαM α − β 1 (cid:1)−τcβcβ (57) ≈ck α z j qk ·gi(cid:1)q(cid:3) (63)
α α
Similarly,
then Eq. 56 becomes
1 z
Θi
j
(cid:1)q−cα ,q(cid:3)≡(cid:8)g
j
(cid:1)q−cα (cid:3)−g
j
(cid:1)q(cid:3)(cid:9)·gi(cid:1)q(cid:3)
JΠij,(1) (cid:1)−(cid:16)τ− (cid:17)(cid:10)cicj(cid:12)(cid:18)z +ck (cid:19)Neq−δN(0)(cid:13) (58) zg(cid:1)q(cid:3)
2 α α α t0 αzqk α α ≈ −ck α z j qk ·gi(cid:1)q(cid:3) (64)
Substitute JΠij,(1) of the above into Eq. 54, we get
Consequently,whensubstituteEqs63,64inEq.62,weobtain,to
z ⎧⎨ 1 z ⎫⎬ the leading order
z
t1
(cid:10)ci
α
N
α
eq−
zqj
⎩(cid:16)τ−
2
(cid:17)(cid:10)ci
α
cj
α
(cid:12)(cid:18)z
t0
+ck
αzqk
(cid:19)N
α
eq−δN
α
(0)(cid:13)⎭
α α 1
+ 1
2
(cid:10)ci
α
(cid:18)z
t0
+cj
αz
z
qj
(cid:19)δN
α
(0) J(cid:1)q(cid:3)Fi(cid:1)q,t(cid:3)(cid:1)− 2 Γi jk (cid:1)q(cid:3)(cid:10)
α
cj α ck α (cid:8)Nα ′(cid:1)q,t(cid:3)+Nα (cid:1)q,t(cid:3)(cid:9) (65)
α
where
(cid:1)(cid:10)ciδN(1) (59)
α α
α zg(cid:1)q(cid:3)
Aftersomesimplecancellationsandrearrangements,itbecomes Γi jk (cid:1)q(cid:3)≡ z j qk ·gi(cid:1)q(cid:3) (66)
z (cid:10)ciNeq+ 1 z (cid:10)ciδN(0) istheChristoffelsymbolasdefinedindifferentialgeometry[13].
t1 α α α 2 t0 α α α Also in the above, the relationship Eq. 22 is used, namely
−
z
z
qj
⎡⎣(cid:16)τ− 1
2
(cid:17)(cid:10)ci
α
cj
α
(cid:18)z
t0
+ck
αz
z
qk
(cid:19)N
α
eq⎤⎦ Nα (cid:1)q+cα ,t+1(cid:3)(cid:1)Nα ′(cid:1)q,t(cid:3) (67)
α Furthermore, since
z
+ ⎡⎣τ(cid:10)cicjδN(0)⎤⎦ z
zqj α α α α Nα (cid:1)q+cα ,t+1(cid:3)≈Nα (cid:1)q,t(cid:3)+(cid:18)z t0 +ck αzqk (cid:19)Nα (cid:1)q,t(cid:3)
(cid:1)(cid:10)ciδN(1) (60)
α α
α we have from Eq. 65 the following
e
U
q
s
u
in
iv
g
a
d
le
e
n
fi
t
n
ly
it
e
io
x
n
p
s
re
in
sse
E
d
q.
a
3
s
2,Nα eq (cid:1)Jfα eq,andEq.47,Eq.60canbe
(cid:10)ci
α
δNα (cid:1)q,t(cid:3)(cid:1)J(cid:1)q(cid:3)Fi(cid:1)q,t(cid:3)
α
z (cid:1)JρUi(cid:3)+ 1 z (cid:1)Jρa(0),i(cid:3) (cid:1)−Γi jk (cid:1)q(cid:3)(cid:10)cj α ck α Nα (cid:1)q,t(cid:3)
t1 2 t0 α
−
z
z
qj
⎡⎣(cid:16)τ− 1
2
(cid:17)(cid:10)ci
α
cj
α
(cid:18)z
t0
+ck
αz
z
qk
(cid:19)N
α
eq⎤⎦ − 1
2
Γi
jk
(cid:1)q(cid:3)(cid:10)cj
α
ck
α
(cid:18)z
t0
+cl
αz
z
ql
(cid:19)Nα (cid:1)q,t(cid:3) (68)
α α
+ z ⎡⎣τ(cid:10)cicjδN(0)⎤⎦(cid:1)Jρa(1),i (61) Comparing terms of the same order in ϵ, we recognize that
zqj
α
α α α
(cid:10)ciδN(0) (cid:1)Jρa(0),i (cid:1)−Γi (cid:10)cjckNeq (69)
α α jk α α α
where in the above we have defined Jρa (1),i ≡& αci
α
δN
α
(1) . α α
Now let us examine the forcing terms Jρa (0),i and Jρa (1),i. and
Recall from the momentum conservation condition, the overall (cid:10)ciδN(1) (cid:1)Jρa(1),i (cid:1)−Γi (cid:10)cjckN(1) (70)
forcing term in Eq. 12 is given by Eq. 28, that is α α jk α α α
α α
1 z
(cid:10)ci
α
δNα (cid:1)q,t(cid:3)(cid:1)J(cid:1)q(cid:3)Fi(cid:1)q,t(cid:3) −
2
Γi
jk
(cid:10)cj
α
ck
α
(cid:18)z
t0
+cl
αzql
(cid:19)N
α
eq (71)
α α
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 8 June2021|Volume7|Article691582

==================================================
頁 9
==================================================
Chen CurvilinearLBM
Replacing N(1) with that in Eq. 40, with the use of property which has exactly the same form as that from the continuum
α
Eq. 57 and after some straightforward algebra, Eq. 71 kinetic theory. On the other hand, from Eq. 74 we have
becomes
1 1 z
(cid:10)ciδN(1) (cid:1)Jρa(1),i
Πij,neq (cid:1)−(cid:16)τ−
2
(cid:17)(cid:12)z
t0
Πij,eq+
J zqk
(cid:21)JQijk,eq(cid:22)(cid:13)
α α
α τ
⎧⎨ 1 z + J (cid:10)ci α cj α δN α (0) (81)
(cid:1)Γi jk ⎩ (cid:16)τ− 2 (cid:17)(cid:10)cj α ck α (cid:18)z t0 +cl αzql (cid:19)N α eq α
α where, fromEq. 32,Πij,eq isgivenby Eq. 80and Qijk,eq isgiven
⎫⎬
−τ(cid:10)cj α ck α δN α (0) ⎭ (72) below
α Qijk,eq (cid:1)(cid:8)gijU ~k+gjkU ~i+gkiU ~j(cid:9)ρT +ρU ~i U ~j U ~k (82)
0
From the definition Eqs 52, 69, we see that
which has exactly the same form as that from the continuum
Jρa(0),i (cid:1)−Γi jk JΠjk,eq (73) kinetic theory. However, the term τ& α ci α cj α δN α (0) needs to be
further evaluated in terms of the hydrodynamic quantities.
Similarly, let us also define
From Eqs 29, 30, we have
JΠij,neq ≡ −(cid:16)τ− 1 2 (cid:17)(cid:10) α ci α cj α (cid:18)z t0 +ck αz z qk (cid:19)N α eq (cid:10) α ci α cj α δNα (cid:1)q,t(cid:3)(cid:1)J(cid:1)q(cid:3)(cid:4)δΠij(cid:1)q,t(cid:3)+δΠji(cid:1)q,t(cid:3)(cid:5) (83)
+τ(cid:10)cicjδN(0) with
α α α
α
(cid:1)−(cid:16)τ− 1 (cid:17)(cid:12)z (cid:1)JΠij,eq(cid:3)+ z (cid:21)JQijk,eq(cid:22)(cid:13) (74) δΠij(cid:1)q,t(cid:3)≡ − 1 2 (cid:16)1− 2 1 τ (cid:17)(cid:10) α cj α ck α (cid:4)Θi k (cid:1)q+cα ,q(cid:3)−Θi k (cid:1)q−cα ,q(cid:3)(cid:5)f α eq(cid:1)q,t(cid:3)
2 t0 zqk
(84)
+τ(cid:10)cicjδN(0)
α α α Takingthelongwavelengthlimit,Eq.84inthecontinuumlimit
α
becomes
where
1
JQijk,eq ≡(cid:10)ci
α
cj
α
ck
α
N
α
eq (75) δΠij(cid:1)q,t(cid:3)≈ −(cid:16)1− 2τ (cid:17)Γi kl (cid:1)q(cid:3)(cid:10)
α
cj α ck α cl α f α eq(cid:1)q,t(cid:3)
α
1
(cid:1)−(cid:16)1− (cid:17)Γi (cid:1)q(cid:3)Qjkl,eq(cid:1)q,t(cid:3) (85)
Hence, from Eq. 72, we have 2τ kl
Jρa(1),i (cid:1)−Γi JΠjk,neq (76) Therefore,
jk
1
Taking Eq. 73 to Eq. 53, we have for the leading order the
τ(cid:10)ci
α
cj
α
δN
α
(0) (cid:1)−(cid:16)τ−
2
(cid:17)J(cid:1)q(cid:3)(cid:8)Γi
kl
(cid:1)q(cid:3)Qjkl,eq(cid:1)q,t(cid:3)
α
equation below
+Γj (cid:1)q(cid:3)Qikl,eq(cid:1)q,t(cid:3)(cid:9) (86)
z kl
z t0 (cid:1)JρUi(cid:3)+ zqj (cid:1)JΠij,eq(cid:3)+Γi jk JΠjk,eq (cid:1)0 (77) So we finally obtain from Eq. 81 that
On the other hand, taking Eqs 74, 76 to Eq. 61, we get in the Πij,neq (cid:1)−(cid:16)τ− 1 (cid:17)(cid:20)z Πij,eq+ 1 z (cid:21)JQijk,eq(cid:22)
viscous order 2 t0 J zqk
(cid:15)
z t1 (cid:1)JρUi(cid:3)+ 1 2 z t0 (cid:1)Jρa(0),i(cid:3)+ z z qj (cid:1)JΠij,neq(cid:3)+Γi jk JΠjk,neq (cid:1)0 (78) +(cid:8)Γi kl (cid:1)q(cid:3)Qjkl,eq+Γj kl (cid:1)q(cid:3)Qikl,eq(cid:9) (87)
with Πij,eq and Qijk,eq given by Eqs 80, 82.
CombiningEqs.77,78togetherandusingthedefinitioninEq.
SubstitutingEqs80,87intoEq.79,comparingwitheqn(B.9)
48, one obtains formally the Cauchy’s transport equation, inSupplementaryAppendixSA2,togetherwiththedefinitions
namely
ofEqs80,82(havingthesameformsasthatfromthecontinuum
z(cid:21)ρU ~i(cid:22)+ 1 z (cid:1)JΠij(cid:3)+Γi Πjk (cid:1)0 (79) kinetic theory), we finally arrive at exactly the same form as
t J zqj jk derived out of a continuum kinetic theory in curvilinear
coordinates. The only difference between the two is that the
where Πjk (cid:1)Πjk,eq+Πjk,neq. collision time τ is replaced by (τ−1/2) here. The rest of
Eq. 79 can be further expressed in terms of hydrodynamic derivation for obtaining the Navier-Stokes hydrodynamics is a
quantities. From the moment properties of the equilibrium straightforward algebra and is no different from that of the
distribution function in Eq. 32, we have continuum kinetic theory in curvilinear coordinates (provided
in Supplementary Appendices SA1, SA2). Notice, same as the
Πij,eq (cid:1)gijρT 0 +ρU ~i U ~j (80) derivation in the continuum kinetic theory, in Eq. 87 the 0th
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 9 June2021|Volume7|Article691582

==================================================
頁 10
==================================================
Chen CurvilinearLBM
ordertimederivativetermz Πij,eqistobereplacedbytheleading that the current LBM formulation recovers the correct Navier-
t0
(Euler) order equations on the right hand sides of Eqs 43, 77. Stokesbehaviorinthehydrodynamiclimit,aslongasadiscrete
Without repeating the rest of algebra, here we present the final latticevelocitysetsatisfyingasufficientorderofisotropyisused.
form - the Navier-Stokes equation in a general curvilinear ExtensivenumericalvalidationsofthisextendedLBMforvarious
coordinate system, flowsonvariouscurvilinearmeshesaretobepresentedinfuture
publications. The main benefit of this kind of theoretical
z(cid:21)ρU ~i(cid:22)+ 1 z (cid:21)JρU ~i U ~j(cid:22)+Γi ρU ~j U ~k formulation in a general curvilinear coordinate system is its
t J zqj jk
preservation of the key LBM one-to-one Lagrangian nature of
(cid:1)−gij zp + 1 z (cid:1)2JμSij(cid:3)+2Γi μSjk (88) particle advection. Not only this is desirable in algorithmic
zqj J zqj jk simplicity, as a standard LBM on a Cartesian lattice, it also
has non-trivial implications for flows at finite Knudsen
where the pressure p(cid:1)ρT , μ(cid:1)(τ−1/2)ρT , and
0 0 number [7–9]. Although the specific LBM model constructed
Sij (cid:1) 1 (cid:8)U ~i
(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)
gkj+U ~j
(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)
gki(cid:9) here is for an isothermal fluid, the fundamental framework is
2 k k directlyextendabletomoregeneralfluidflowsituations.Possible
withthestandardcovariantderivativeofthevelocitycomponent extensionsinthefuturemayincludetransportofscalars,complex
defined as fluids, finite Knudsen flows, as well as higher speed flows with
U ~i
(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)k
≡ z
z
U
q
~
k
i +Γi
kl
U ~l
e
e
su
n
ss
b
e
e
r
s
n
g
ta
t
y
i
n
a
a
t
l
i
n
a
f
d
o
l
r
t
t
e
e
s
m
m
tu
p
p
d
e
e
y
r
r
a
a
o
t
t
u
f
u
r
r
h
e
e
ig
v
d
h
a
y
l
r
y
n
ia
a
c
t
m
i
o
o
m
i
n
c
s
s
p
.
r
i
A
n
es
n
s
c
i
o
u
b
t
r
l
h
v
e
e
e
fl
r
d
o
i
s
n
w
p
t
s
a
e
c
r
a
e
e
n
s
.
t
d
T
in
h
fl
g
e
o
p
w
la
o
s
t
s
t
s
w
e
i
r
b
it
l
i
h
e
s
extension of the current theoretical formulation in the future is
Using the standard definitions of differential operators in for a time varying coordinate system. Thisis usefulparticularly
differential geometry [13], we can recognize that Eq. 88 is forstudyingoffluidflowsaroundadynamicallydeformingsolid
indeed the familiar Navier-Stokes equation in a generic object.
coordinate-free operator representation,
z(cid:1)ρu~(cid:3)+∇·(cid:1)ρu~u~(cid:3)(cid:1)−∇p+∇·(cid:1)2μS(cid:3) (89)
t DATA AVAILABILITY STATEMENT
Theoriginalcontributionspresentedinthestudyareincludedin
4 DISCUSSION the article/Supplementary Material, further inquiries can be
directed to the corresponding author.
In this paper, we present a theoretical formulation of lattice
Boltzmann models in a general curvilinear coordinate system.
The formulation is an application of the Riemannian geometry AUTHOR CONTRIBUTIONS
for kinetic theory [14] to discrete space and time. Unlike some
previousworks[16–18],hereweuseavolumetricrepresentation Theauthorconfirmsbeingthesolecontributorofthisworkand
sothatconservationlawsareexactlyensured[11].Furthermore, has approved it for publication.
in the current formulation, we find that the main and the only
additional source term in the extended LBM model is
corresponding to the inertial force to ensure the exact ACKNOWLEDGMENTS
momentum conservation in the underlying Euclidean space.
This is the same as in the continuum kinetic theory. On the I am grateful to Raoyang Zhang, Pradeep Gopalakrishnan, Ilya
other hand, this forcing term needs to be applied at an Staroselsky and Alexei Chekhlov for insightful discussions.
appropriate discrete time in order to realize the correct viscous
fluid effect associated with non-equilibrium physics. The
equilibrium distribution function also needs to be properly SUPPLEMENTARY MATERIAL
modified that is directly analogous to the Maxwell-Boltzmann
distributiononacurvedspace.Unlikethepreviousformulations TheSupplementaryMaterialforthisarticlecanbefoundonlineat:
[16–18],therearenoothertermsortreatmentsaddedtocancel https://www.frontiersin.org/articles/10.3389/fams.2021.691582/
anydiscreteartifacts.Throughadetailedanalysis,wehaveshown full#supplementary-material
REFERENCES 2. ChenS,andDoolenGD.LatticeBoltzmannMethodforFluidFlows.AnnuRev
FluidMech(1998).30:329–64.doi:10.1146/annurev.fluid.30.1.329
3. HuangK.StatisticalMechanics.2nded.India:JohnWiley(1987).
1. BenziR,SucciS,andVergassolaM.TheLatticeBoltzmannEquation:Theoryand 4. Cercignani C. The Boltzmann Equation and its Applications. New York:
Applications.PhysRep(1992).222:145–97.doi:10.1016/0370-1573(92)90090-m Springer-Verlag(1975).
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 10 June2021|Volume7|Article691582

==================================================
頁 11
==================================================
Chen CurvilinearLBM
5. QianYH,D’HumièresD,andLallemandP.LatticeBGKModelsforNavier-Stokes 19. Chen H, and Shan X, Fundamental Conditions for N-Th-Order Accurate
Equation.EurophysLett(1992).17:479–84.doi:10.1209/0295-5075/17/6/001 Lattice Boltzmann Models, Physica D 237, issues: 14-17, 2003–8. (2007).
6. ChenH,GoldhirschI,andOrszagSA.DiscreteRotationalSymmetry,Moment doi:10.1016/j.physd.2007.11.010
Isotropy,andHigherOrderLatticeBoltzmannModels.JSciComput(2008). 20. Chen H, Teixeira C, and Molvig K. Digital Physics Approach to
34:87–112.doi:10.1007/s10915-007-9159-3 Computational Fluid Dynamics: Some Basic Theoretical Features. Intl
7. Shan X, Yuan X-F, and Chen H. Kinetic Theory Representation of JModPhysC(1997).9(8):675.doi:10.1142/s0129183197000576
Hydrodynamics: a Way beyond the Navier-Stokes Equation. J Fluid Mech 21. FrischU,D’HumieresD,HasslacherB,LallemandP,PomeauY,andRivetJP.
(2006).550:413.doi:10.1017/s0022112005008153 Lattice Gas Hydrodynamics in Two and Three Dimensions. Complex Syst
8. Chen H,ZhangR, Staroselsky I,and JhonM. Recovery ofFull Rotational (1987).1:649–707.
Invariance in Lattice Boltzmann Formulations for High Knudsen Number 22. ChenS,ChenH,MartnezD,andMatthaeusW.LatticeBoltzmannModelfor
Flows.PhysicaA:StatMechitsAppl(2006).362:125–31.doi:10.1016/j.physa. Simulation of Magnetohydrodynamics. Phys Rev Lett (1991). 67:3776–9.
2005.09.008 doi:10.1103/physrevlett.67.3776
9. ZhangR,ChenH,andShanX.EfficientKineticMethodforFluidSimulation 23. ChenH,ChenS,andMatthaeusW.RecoveryoftheNavier-StokesEquations
beyondtheNavier-StokesEquation.PhysRew.E(2006).74:046703.doi:10. Using a Lattice-Gas Boltzmann Method. Phys.Rev A (1992). 45:5339–42.
1103/physreve.74.046703 doi:10.1103/physreva.45.r5339
10. HeX,LuoL-S,andDemboM.SomeProgressinLatticeBoltzmannMethod 24. BhatnagarPL,GrossEP,andKrookM.AModelforCollisionProcessesin
PartINonuniformMeshGrids.JComputPhys(1996).129:357–63.doi:10. GasesfsISmallAmplitudeProcessesinChargedandNeutralOne-Component
1006/jcph.1996.0255 Systems.PhysRev(1954).94(3):511–25.doi:10.1103/physrev.94.511
11. ChenH.VolumetricFormulationoftheLatticeBoltzmannMethodforFluid 25. Latt J, and Chopard B. Lattice Boltzmann Method with Regularized Pre-
Dynamics: Basic Concept. Phys Rev E (1998). 58:3955–63. doi:10.1103/ collisionDistributionFunctions.MathComputSimulat(2006).72(2-6):165.
physreve.58.3955 doi:10.1016/j.matcom.2006.05.017
12. Barraza JAR, and Dieterding R. Towards a Generalised Lattice-Boltzmann 26. ChenH,GopalakrishnanP,andZhangR.RecoveryofGalileanInvariancein
Method for Aerodynamic Simulations. J Comput Phys (2019). 45:101182. thermalLatticeBoltzmannModelsforArbitraryPrandtlNumber.IntJMod
doi:10.1016/j.jocs.2020.101182 PhysC(2014).25(10):1450046.doi:10.1142/s0129183114500466
13. ArisR.Vectors,Tensors,andtheBasicEquationsofFluidMechanics.New 27. ChenH,ZhangR,andGopalakrishnanP.FilteredLatticeBoltzmannCollision
York:Dover(1962). FormulationEnforcingIsotropyandGalileanInvariance.PhysScr(2020).95:
14. Vedenyapin V, Sinitsyn A, and Dulov E. Kinetic Boltzmann, Vlasov and 034003.doi:10.1088/1402-4896/ab4b4d
RelatedEquations.London:Elsevier(2011). 28. ChapmanS,andCowlingT.TheMathematicalTheoryofNon-uniformGases.
15. LovePJ,andCianciD.FromtheBoltzmannEquationtoFluidMechanicsona 3rded.Cambridge:CambridgeUniv.Press(1990).
Manifold.PhilTransRSocA(2011).369:2362–70.doi:10.1098/rsta.2011.0097
16. MendozaM,DebusJ-D,SucciS,andHerrmannHJ.LatticeKineticSchemefor ConflictofInterest:AuthorHCwasemployedbythecompanyDassaultSystemes.
GeneralizedCoordinatesandCurvedSpaces.IntJModPhysC(2014).25:
1441001.doi:10.1142/s0129183114410010 Copyright©2021Chen.Thisisanopen-accessarticledistributedunderthetermsof
17. Debus J-D, Mendoza M, and Herrmann HJ. Dean Instability in Double- the Creative Commons Attribution License (CC BY). The use, distribution or
Curved Channels. Phys Rev E (2014). 90:053308. doi:10.1103/physreve.90. reproduction in other forums is permitted, provided the original author(s) and
053308 thecopyrightowner(s)arecreditedandthattheoriginalpublicationinthisjournalis
18. DebusJ-D,MendozaM,SucciS,andHerrmannHJ.PoiseuilleFlowinCurved cited, in accordance with accepted academic practice. No use, distribution or
Spaces.PhysRevE(2016).93:043316.doi:10.1103/physreve.93.043316 reproductionispermittedwhichdoesnotcomplywiththeseterms.
FrontiersinAppliedMathematicsandStatistics|www.frontiersin.org 11 June2021|Volume7|Article691582